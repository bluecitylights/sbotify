@startuml
skinparam {
  shadowing false
  componentStyle rectangle
  defaultTextAlignment center
}

actor "User" as user

cloud "Google Cloud Run" as cloud {
  component "mcp-server" as mcp_server {
    [fastmcp + htmx]
  }

  component "chat" as chat {
    [fastapi + htmx]
    [Google.genai]
  }

  component "dashboard" as dashboard {
    [fastapi + htmx]
  }
}

' Interactions
user --> dashboard : "Accesses"
user --> chat : "Interacts with\n(standalone on /)"
dashboard -left-> chat : "Aggregates chat fragment\nfrom /chat route"
chat -up-> mcp_server : "Connects to\n/mcp route"
dashboard -left-> chat : "Rewrites htmx URLs\n(client-side aggregation)"

note bottom of chat
Serves index.html on /
Fragment served on /chat
end note
@enduml